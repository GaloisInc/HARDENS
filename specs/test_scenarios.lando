// Scenarios are sequences of events.  Scenarios document normal and
// abnormal traces of system execution.

// Test scenarios are scenarios that validate a system conforms to its
// requirements through runtime verification (testing).  Each scenario
// is refined to a (possibly parametrized) runtime verification
// property.  If a testbench is complete, then every path of a
// system's state machine should be covered by the its set of scenarios.

scenarios Self-Test Scenarios

Normal Self-Test Behavior 1a - Trip on Mock High Pressure Reading from that Pressure Sensor
The user selects 'maintenance' for an instrumentation division, the
division's pressure channel is set to 'normal' mode, the pressure
setpoint is set to a value v, the user simulates a pressure input to
that division exceeding v, the division generates a pressure trip.

Normal Self-Test Behavior 1b - Trip on Environmental High Pressure Reading from that Pressure Sensor
The user selects 'maintenance' for an instrumentation division, the
division's pressure channel is set to 'normal' mode, the pressure
setpoint is set to a value v, the division reads a pressure sensor
value division exceeding v, the division generates a pressure trip.

Normal Self-Test Behavior 2a - Trip on Mock High Temperature Reading from that Temperature Sensor
The user selects 'maintenance' for an instrumentation division, the
division's temperature channel is set to 'normal' mode, the
temperature setpoint is set to a value v, the user simulates a
temperature input to that division exceeding v, the division generates
a temperature trip.

Normal Self-Test Behavior 2a - Trip on Environmental High Temperature Reading from that Temperature Sensor
The user selects 'maintenance' for an instrumentation division, the
division's temperature channel is set to 'normal' mode, the
temperature setpoint is set to a value v, the division reads a
temperature sensor value division exceeding v, the division generates
a temperature trip.

Normal Self-Test Behavior 3a - Trip on Mock Low Saturation Margin
The user selects 'maintenance' for an instrumentation division, the
division's saturation channel is set to 'normal' mode, the saturation
margin setpoint is set to a value v, the user simulates pressure and
temperature inputs to that division such that the saturation margin is
below v, the division generates a saturation margin trip.

Normal Self-Test Behavior 3a - Trip on Environmental Low Saturation Margin
The user selects 'maintenance' for an instrumentation division, the
division's saturation channel is set to 'normal' mode, the saturation
margin setpoint is set to a value v, the division reads pressure and
temperature sensor values in that division such that the saturation
margin is below v, the division generates a saturation margin trip.

Normal Self-Test Behavior 4 - Vote on Every Possible Like Trip
The user selects 'maintenance' for each instrumentation division, the
user configures a subset of channels to place in active trip output.

Normal Self-Test Behavior 5a - Automatically Actuate All Mock Devices in Sequence
The user selects 'maintenance' for each instrumentation division, the
user places enough channels in 'active trip' to actuate a mock device.

Normal Self-Test Behavior 5b - Automatically Actuate All Hardware Devices in Sequence
The user selects 'maintenance' for each instrumentation division, the
user places enough channels in 'active trip' to actuate a hardware
device.

Normal Self-Test Behavior 6 - Manually Actuate Each Device in Sequence
The user manually actuates each device.

Normal Self-Test Behavior 7a - Select Maintenance Operating Mode for each Division
The user selects 'maintenance' mode for each instrumentation division
in sequence.

Normal Self-Test Behavior 7b - Select Normal Operating Mode for each Division
The user exits 'maintenance' mode for each instrumentation division in
sequence.

Normal Self-Test Behavior 8 - Perform Each Kind of Setpoint Adjustment
For each instrumentation division, the user provides a setpoint for
temperature, then the user provides a setpoint for pressure, then the
user provides a setpoint for saturation margin.

Normal Self-Test Behavior 9 - Configure Bypass of Each Instrument Channel in Sequence
For each instrumentation division, the user puts each channel in
'normal' and then 'bypass' mode.

Normal Self-Test Behavior 10 - Configure Active Trip Output State of Each Instrument Channel in Sequence
For each instrumentation division, the user puts each channel in
'trip' and then 'normal' mode.

Normal Self-Test Behavior 11 - Display Pressure, Temperature, and Saturation Margin
The user provides inputs for an instrumentation division, then the UI
displays the updated pressure, temperature and saturation margin.

Normal Self-Test Behavior 12 - Display Every Trip Output Signal State in Sequence
The user configures an instrumentation division in 'maintenance',
selects a channel and places it in 'trip', the UI displays the trip
state, the user places the channel in 'normal' mode, the UI displays
the trip state.

Normal Self-Test Behavior 13 - Display Indication of Every Channel in Bypass in Sequence
The user configures an instrumentation division in 'maintenance', the
user selects a channel and places it in bypass, the UI displays the
bypass state, the user places the channel in normal mode, the UI
displays the updated state.

Normal Self-Test Behavior 14 - Demonstrate Periodic Continual Self-test of Safety Signal Path
The system starts, eventually the UI displays that self test has run.

Normal Self-Test Behavior 15 - Full Self-Test
The system simulates input to two instrumentation units and a device,
then the system checks that the correct actuation signal is sent to
the selected device.

// Exceptional behaviors are *predictable* system behaviors triggered
// by external environment affects.  Examples include a CPU, OS,
// device, or network total or partial failure.  E.g., CPU deadlock,
// out-of-memory errors, permanent store partial and total failures,
// lack of space in permanent store, partial and total network
// failures, device driver partial or total failures, etc.

// In our architecture, every part of the RTS system, and particularly
// every part of the instrumentation and sensing subsystem and every
// part of the actuation subsystem must be able to fail and the system
// must respond appropriately.

Exceptional Self-Test Behavior 1a - Cause Actuator 1 to Fail
Manually actuate actuator 1, the actuator fails, an error is
indicated.

Exceptional Self-Test Behavior 1b - Cause Actuator 2 to Fail
Manually actuate actuator 2, the actuator fails, an error is
indicated.

Exceptional Self-Test Behavior 1c - Non-deterministically Cause an Actuator to Eventually Fail
Repeatedly manually actuate/unactuate an actuator, the actuator fails,
an error is indicated.

Exceptional Self-Test Behavior 2a - Cause Temperature Sensor 1 to Fail
Temperature sensor 1 reports readings that are inconsistent with
temperature sensor 2, the discrepancy is indicated on the UI.

Exceptional Self-Test Behavior 2b - Cause Temperature Sensor 2 to Fail
Temperature sensor 2 reports readings that are inconsistent with
temperature[ sensor 1, the discrepancy is indicated on the UI.

Exceptional Self-Test Behavior 2c - Non-deterministically Cause a Temperature Sensor to Eventually Fail
Temperature sensor 1 or temperature sensor 2 report inconsistent
values, discrepancy is indicated on the UI.

Exceptional Self-Test Behavior 3a - Cause Pressure Sensor 1 to Fail
Pressure sensor 1 reports readings that are inconsistent with pressure
sensor 2, the discrepancy is indicated on the UI.

Exceptional Self-Test Behavior 3b - Cause Pressure Sensor 2 to Fail
Pressure sensor 2 reports readings that are inconsistent with pressure
sensor 1, the discrepancy is indicated on the UI.

Exceptional Self-Test Behavior 3c - Non-deterministically Cause a Pressure Sensor to Eventually Fail
Temperature sensor 1 or temperature sensor 2 report inconsistent
values, discrepancy is indicated on the UI.

Exceptional Self-Test Behavior 4a - Cause Instrumentation Unit 1 to Fail
A channel input exceeds its setpoint, instrumentation unit 1 does not
generate a trip signal.

Exceptional Self-Test Behavior 4b - Cause Instrumentation Unit 2 to Fail
A channel input exceeds its setpoint, instrumentation unit 2 does not
generate a trip signal.

Exceptional Self-Test Behavior 4c - Cause Instrumentation Unit 3 to Fail
A channel input exceeds its setpoint, instrumentation unit 3 does not
generate a trip signal.

Exceptional Self-Test Behavior 4d - Cause Instrumentation Unit 4 to Fail
A channel input exceeds its setpoint, instrumentation unit 4 does not
generate a trip signal.

Exceptional Self-Test Behavior 4e - Non-Deterministically Cause Instrumentation Unit to Eventually Fail
A channel input exceeds its setpoint, an instrumentation unit reading
the input non-deterministically does not output a trip signal.

// @review kiniry I actually don't know if we are fault tolerant to
// failure in these components.  Please review @abakst.

Exceptional Self-Test Behavior 5a - Cause Temperature Demultiplexor 1 to Fail
Temperature demultiplexor 1 fails, then the system detects the
failure, then resets the CPU that contains the failed demultiplexor.

Exceptional Self-Test Behavior 5b - Cause Temperature Demultiplexor 2 to Fail
Temperature demultiplexor 2 fails, then the system detects the
failure, then resets the CPU that contains the failed demultiplexor.

Exceptional Self-Test Behavior 5b - Cause a Temperature Demultiplexor to Eventually Fail
A temperature demultiplexor non-deterministically fails, then the
system detects the failure, then resets the CPU which contains the
failed demultiplexor.
